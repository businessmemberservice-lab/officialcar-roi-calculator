<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公務車成本 vs 會員乘車服務 投資分析</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #c62828 0%, #d32f2f 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .input-section {
            background: #fff3e0;
            border-radius: 15px;
            padding: 25px;
            border: 3px solid #ff9800;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: #e65100;
            text-align: center;
            text-transform: uppercase;
        }

        .input-group {
            margin-bottom: 18px;
        }

        .input-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #424242;
            font-size: 0.95rem;
        }

        .input-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-row input {
            flex: 1;
            padding: 10px;
            border: 2px solid #ff9800;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            background: white;
        }

        .input-row .unit {
            font-weight: bold;
            color: #666;
            min-width: 80px;
            font-size: 0.9rem;
        }

        .comparison-section {
            background: #e8f5e8;
            border-radius: 15px;
            padding: 25px;
            border: 3px solid #4caf50;
        }

        .comparison-section .section-title {
            color: #2e7d32;
        }

        .cost-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .cost-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .cost-card h3 {
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: #424242;
        }

        .cost-card .amount {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .company-car .amount {
            color: #d32f2f;
        }

        .service-cost .amount {
            color: #2e7d32;
        }

        .savings-highlight {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-top: 20px;
        }

        .savings-highlight h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }

        .savings-highlight .value {
            font-size: 2.5rem;
            font-weight: bold;
        }

        .detailed-breakdown {
            grid-column: 1 / -1;
            background: #f5f5f5;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }

        .breakdown-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
        }

        .breakdown-table th {
            background: #37474f;
            color: white;
            padding: 15px;
            text-align: left;
        }

        .breakdown-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .breakdown-table tr:hover {
            background: #f8f9fa;
        }

        .company-car-cost { color: #d32f2f; font-weight: bold; }
        .service-cost { color: #2e7d32; font-weight: bold; }
        .savings { color: #1976d2; font-weight: bold; }

        .roi-analysis {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #1976d2 0%, #1e88e5 100%);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }

        .roi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .roi-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .roi-card h4 {
            font-size: 0.9rem;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .roi-card .value {
            font-size: 2rem;
            font-weight: bold;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            transition: transform 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-primary {
            background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
            color: white;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .cost-comparison {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🚗 公務車 vs 會員乘車服務</h1>
            <p>全面成本分析 | 專為有公務車企業設計</p>
        </div>

        <div class="main-content">
            <!-- 公務車成本輸入 -->
            <div class="input-section">
                <div class="section-title">🚙 公務車年度成本</div>
                
                <div class="input-group">
                    <label>公務車數量</label>
                    <div class="input-row">
                        <input type="number" id="carCount" value="2" min="1">
                        <span class="unit">台</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>車輛折舊費用</label>
                    <div class="input-row">
                        <input type="number" id="depreciation" value="200000" min="0">
                        <span class="unit">元/台/年</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>油料費用</label>
                    <div class="input-row">
                        <input type="number" id="fuelCost" value="120000" min="0">
                        <span class="unit">元/台/年</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>保險費用</label>
                    <div class="input-row">
                        <input type="number" id="insurance" value="25000" min="0">
                        <span class="unit">元/台/年</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>維修保養費</label>
                    <div class="input-row">
                        <input type="number" id="maintenance" value="40000" min="0">
                        <span class="unit">元/台/年</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>停車費用</label>
                    <div class="input-row">
                        <input type="number" id="parking" value="36000" min="0">
                        <span class="unit">元/台/年</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>司機薪資</label>
                    <div class="input-row">
                        <input type="number" id="driverSalary" value="480000" min="0">
                        <span class="unit">元/人/年</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>需要司機人數</label>
                    <div class="input-row">
                        <input type="number" id="driverCount" value="1" min="0">
                        <span class="unit">人</span>
                    </div>
                </div>
            </div>

            <!-- 會員服務成本 -->
            <div class="comparison-section">
                <div class="section-title">🎯 會員乘車服務</div>
                
                <div class="input-group">
                    <label>預估月差旅次數</label>
                    <div class="input-row">
                        <input type="number" id="monthlyTrips" value="80" min="1">
                        <span class="unit">次</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>平均每趟車資</label>
                    <div class="input-row">
                        <input type="number" id="avgTripCost" value="350" min="1">
                        <span class="unit">元</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>服務年費</label>
                    <div class="input-row">
                        <input type="number" id="serviceFee" value="50000" min="0">
                        <span class="unit">元/年</span>
                    </div>
                </div>

                <div class="cost-comparison">
                    <div class="cost-card company-car">
                        <h3>公務車年度總成本</h3>
                        <div class="amount" id="totalCarCost">$901,000</div>
                        <small>包含所有固定與變動成本</small>
                    </div>
                    <div class="cost-card service-cost">
                        <h3>會員服務年度總成本</h3>
                        <div class="amount" id="totalServiceCost">$386,000</div>
                        <small>車資 + 年費</small>
                    </div>
                </div>

                <div class="savings-highlight">
                    <h3>每年可節省</h3>
                    <div class="value" id="annualSavings">$515,000</div>
                    <p>節省比例: <span id="savingsPercentage">57%</span></p>
                </div>
            </div>
        </div>

        <!-- 詳細成本拆解 -->
        <div class="detailed-breakdown">
            <h3 style="text-align: center; margin-bottom: 20px; color: #37474f;">💰 詳細成本比較分析</h3>
            <table class="breakdown-table">
                <thead>
                    <tr>
                        <th>成本項目</th>
                        <th>公務車成本</th>
                        <th>會員服務</th>
                        <th>差額節省</th>
                        <th>說明</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>車輛折舊</td>
                        <td class="company-car-cost" id="depreciationTotal">$400,000</td>
                        <td class="service-cost">$0</td>
                        <td class="savings" id="depreciationSaving">$400,000</td>
                        <td>無需購車投資</td>
                    </tr>
                    <tr>
                        <td>油料費用</td>
                        <td class="company-car-cost" id="fuelTotal">$240,000</td>
                        <td class="service-cost">包含在車資內</td>
                        <td class="savings" id="fuelSaving">$240,000</td>
                        <td>隨叫隨用，無空車成本</td>
                    </tr>
                    <tr>
                        <td>保險費用</td>
                        <td class="company-car-cost" id="insuranceTotal">$50,000</td>
                        <td class="service-cost">$0</td>
                        <td class="savings" id="insuranceSaving">$50,000</td>
                        <td>無保險風險</td>
                    </tr>
                    <tr>
                        <td>維修保養</td>
                        <td class="company-car-cost" id="maintenanceTotal">$80,000</td>
                        <td class="service-cost">$0</td>
                        <td class="savings" id="maintenanceSaving">$80,000</td>
                        <td>無維修困擾</td>
                    </tr>
                    <tr>
                        <td>停車費用</td>
                        <td class="company-car-cost" id="parkingTotal">$72,000</td>
                        <td class="service-cost">$0</td>
                        <td class="savings" id="parkingSaving">$72,000</td>
                        <td>無停車問題</td>
                    </tr>
                    <tr>
                        <td>人力成本</td>
                        <td class="company-car-cost" id="driverTotal">$480,000</td>
                        <td class="service-cost">$0</td>
                        <td class="savings" id="driverSaving">$480,000</td>
                        <td>專業司機服務</td>
                    </tr>
                    <tr>
                        <td>實際搭乘費用</td>
                        <td class="company-car-cost">包含在上述</td>
                        <td class="service-cost" id="actualTripCost">$336,000</td>
                        <td class="savings negative">($336,000)</td>
                        <td>按實際使用付費</td>
                    </tr>
                    <tr>
                        <td>服務年費</td>
                        <td class="company-car-cost">$0</td>
                        <td class="service-cost" id="feeTotal">$50,000</td>
                        <td class="savings negative">($50,000)</td>
                        <td>管理平台費用</td>
                    </tr>
                    <tr style="background: #e8f5e8; font-weight: bold;">
                        <td><strong>總計</strong></td>
                        <td class="company-car-cost" id="grandTotalCar">$1,322,000</td>
                        <td class="service-cost" id="grandTotalService">$386,000</td>
                        <td class="savings" id="grandTotalSaving">$936,000</td>
                        <td><strong>年度節省</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ROI 分析 -->
        <div class="roi-analysis">
            <h3 style="text-align: center; margin-bottom: 10px;">📊 投資報酬分析</h3>
            <div class="roi-grid">
                <div class="roi-card">
                    <h4>年度ROI</h4>
                    <div class="value" id="roiPercentage">265%</div>
                </div>
                <div class="roi-card">
                    <h4>投資回收期</h4>
                    <div class="value" id="paybackPeriod">1.4</div>
                    <small>個月</small>
                </div>
                <div class="roi-card">
                    <h4>成本節省比例</h4>
                    <div class="value" id="costReduction">71%</div>
                </div>
                <div class="roi-card">
                    <h4>3年累積節省</h4>
                    <div class="value" id="threeyearSaving">$281萬</div>
                </div>
            </div>
        </div>

        <div style="text-align: center; padding: 20px;">
            <button class="btn btn-primary" onclick="recalculate()">🔄 重新計算</button>
            <button class="btn btn-primary" onclick="generateReport()">📊 生成報告</button>
        </div>
    </div>

    <script>
        const inputs = ['carCount', 'depreciation', 'fuelCost', 'insurance', 'maintenance', 
                       'parking', 'driverSalary', 'driverCount', 'monthlyTrips', 'avgTripCost', 'serviceFee'];
        
        inputs.forEach(id => {
            document.getElementById(id).addEventListener('input', calculateComparison);
        });

        function formatCurrency(num) {
            return new Intl.NumberFormat('zh-TW', {
                style: 'currency',
                currency: 'TWD',
                minimumFractionDigits: 0
            }).format(num).replace('NT$', '$');
        }

        function calculateComparison() {
            // 取得輸入值
            const carCount = parseFloat(document.getElementById('carCount').value) || 0;
            const depreciation = parseFloat(document.getElementById('depreciation').value) || 0;
            const fuelCost = parseFloat(document.getElementById('fuelCost').value) || 0;
            const insurance = parseFloat(document.getElementById('insurance').value) || 0;
            const maintenance = parseFloat(document.getElementById('maintenance').value) || 0;
            const parking = parseFloat(document.getElementById('parking').value) || 0;
            const driverSalary = parseFloat(document.getElementById('driverSalary').value) || 0;
            const driverCount = parseFloat(document.getElementById('driverCount').value) || 0;
            const monthlyTrips = parseFloat(document.getElementById('monthlyTrips').value) || 0;
            const avgTripCost = parseFloat(document.getElementById('avgTripCost').value) || 0;
            const serviceFee = parseFloat(document.getElementById('serviceFee').value) || 0;

            // 計算公務車總成本
            const totalDepreciation = depreciation * carCount;
            const totalFuel = fuelCost * carCount;
            const totalInsurance = insurance * carCount;
            const totalMaintenance = maintenance * carCount;
            const totalParking = parking * carCount;
            const totalDriverCost = driverSalary * driverCount;
            
            const totalCarCost = totalDepreciation + totalFuel + totalInsurance + 
                               totalMaintenance + totalParking + totalDriverCost;

            // 計算會員服務成本
            const annualTripCost = monthlyTrips * avgTripCost * 12;
            const totalServiceCost = annualTripCost + serviceFee;

            // 計算節省
            const annualSavings = totalCarCost - totalServiceCost;
            const savingsPercentage = totalCarCost > 0 ? (annualSavings / totalCarCost * 100) : 0;
            
            // ROI 計算
            const roi = totalServiceCost > 0 ? (annualSavings / totalServiceCost * 100) : 0;
            const paybackMonths = annualSavings > 0 ? (totalServiceCost / (annualSavings / 12)) : 0;
            const costReduction = totalCarCost > 0 ? (annualSavings / totalCarCost * 100) : 0;
            const threeYearSaving = annualSavings * 3;

            // 更新顯示
            document.getElementById('totalCarCost').textContent = formatCurrency(totalCarCost);
            document.getElementById('totalServiceCost').textContent = formatCurrency(totalServiceCost);
            document.getElementById('annualSavings').textContent = formatCurrency(annualSavings);
            document.getElementById('savingsPercentage').textContent = savingsPercentage.toFixed(0) + '%';

            // 更新詳細表格
            document.getElementById('depreciationTotal').textContent = formatCurrency(totalDepreciation);
            document.getElementById('fuelTotal').textContent = formatCurrency(totalFuel);
            document.getElementById('insuranceTotal').textContent = formatCurrency(totalInsurance);
            document.getElementById('maintenanceTotal').textContent = formatCurrency(totalMaintenance);
            document.getElementById('parkingTotal').textContent = formatCurrency(totalParking);
            document.getElementById('driverTotal').textContent = formatCurrency(totalDriverCost);
            document.getElementById('actualTripCost').textContent = formatCurrency(annualTripCost);
            document.getElementById('feeTotal').textContent = formatCurrency(serviceFee);
            document.getElementById('grandTotalCar').textContent = formatCurrency(totalCarCost);
            document.getElementById('grandTotalService').textContent = formatCurrency(totalServiceCost);
            document.getElementById('grandTotalSaving').textContent = formatCurrency(annualSavings);

            // 更新節省金額
            document.getElementById('depreciationSaving').textContent = formatCurrency(totalDepreciation);
            document.getElementById('fuelSaving').textContent = formatCurrency(totalFuel);
            document.getElementById('insuranceSaving').textContent = formatCurrency(totalInsurance);
            document.getElementById('maintenanceSaving').textContent = formatCurrency(totalMaintenance);
            document.getElementById('parkingSaving').textContent = formatCurrency(totalParking);
            document.getElementById('driverSaving').textContent = formatCurrency(totalDriverCost);

            // 更新 ROI 指標
            document.getElementById('roiPercentage').textContent = roi.toFixed(0) + '%';
            document.getElementById('paybackPeriod').textContent = paybackMonths.toFixed(1);
            document.getElementById('costReduction').textContent = costReduction.toFixed(0) + '%';
            document.getElementById('threeyearSaving').textContent = formatCurrency(threeYearSaving / 10000) + '萬';
        }

        function recalculate() {
            calculateComparison();
            alert('計算完成！公務車 vs 會員服務成本分析已更新');
        }

        function generateReport() {
            const savings = document.getElementById('annualSavings').textContent;
            const roi = document.getElementById('roiPercentage').textContent;
            const payback = document.getElementById('paybackPeriod').textContent;
            
            const report = `
🚗 公務車 vs 會員乘車服務 分析報告
=====================================
• 年度節省金額：${savings}
• 投資報酬率：${roi}
• 回收期：${payback} 個月
• 建議：強烈建議改用會員乘車服務！

主要優勢：
✅ 大幅降低固定成本
✅ 無車輛管理困擾  
✅ 按需使用，彈性調整
✅ 專業司機服務
✅ 無保險維修風險
            `;
            
            alert(report);
        }

        // 初始化計算
        calculateComparison();
    </script>
</body>
</html>